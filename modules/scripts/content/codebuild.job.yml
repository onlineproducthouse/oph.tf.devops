version: 0.2

# CI_ACTION
# CI_ACTION_ITEM
# ARTIFACT_PATH
# AWS_S3_SCRIPT_STORE

phases:
  install:
    commands:
      - apt-get update -y
      - apt-get install -y jq

  pre_build:
    commands:
      - JOB_SCRIPT="$CI_ACTION-$CI_ACTION_ITEM.sh"

  build:
    commands:
      - aws s3 cp "$AWS_S3_SCRIPT_STORE/$JOB_SCRIPT" "./$JOB_SCRIPT"
      - bash "./$JOB_SCRIPT"

artifacts:
  type: zip
  files:
    - ${ARTIFACT_PATH}
